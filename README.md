
# RCA LLM Project

## Description

A simple Hugging Face language model fine-tuning project on IT ticket descriptions and resolutions for RCA.
Parts of the project are inspired by or adapted from Andrej Karpathy's minGPT: https://github.com/karpathy/minGPT.

## Project Structure

All the code is in the src folder. Inside, the custom package rca_llm includes:

- `Evaluator.py` Simple custom evaluation utility that allows you to evaluate a model on a dataset using the `eval_split` method.
- `Trainer.py` Simple custom training loop, boilerplate that could apply to any arbitrary neural network.
- `HFModelAdapter.py` Encapsulation class for Hugging Face models to be trained with the Trainer class.
- `RCADataset.py` Inherits from `torch.utils.data.Dataset`, deals with data sampling for the torch loader. Also deals with prompt formatting, padding, and loss mask for the model prediction.
- `utils.py` Simple utilities, mostly for configuration management and logging.

In the src folder, there are 4 other files, among which 3 are notebooks:

- `data_analysis.ipynb`: Exploratory dataset analysis.
- `model_training_and_evaluation_demo.ipynb`: Simple model training and evaluation pipeline in notebook cells, using the custom package rca_llm.
- `result_analysis.ipynb`: Exploration of the performance metric dataset generated by `full_model_train_and_eval_script.py` and the loss curves.

The final file is `full_model_train_and_eval_script.py`, a Python script that generates and saves a dataframe of evaluation metrics as well as training logs for some basic combinations of hyperparameters (such as training duration in number of epochs (or rather number of batches), model type or dataset split).


### Setup

If you want to run this project locally, you have to run (preferably in a virtual environment):

```
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install -e .
```
(For local execution, do not run the first cell of the notebooks, but run the second one adding your working directory.)

If you want to run this project from a Google Colab notebook, open a notebook of the project on Google Colab and run the first cell.
Do not run the second cell.
